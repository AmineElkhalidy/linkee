import{s as le,v as Z,p as J,e as K,g as w,c as E,h as C,i as B,d as j,B as D,k as T,F as Q,G as oe,H as ae,l as R,m as S,A as F}from"../chunks/scheduler.1VmQr9R1.js";import{S as ue,i as ce,d as U,v as re,j as fe,k as me,m as de,b as he,t as _e,l as pe,a as y,e as b,g as k,n as g,p as O,s as I}from"../chunks/index.PIup2QdQ.js";import{A as $}from"../chunks/AuthCheck.7wpwqlKE.js";import{e as V,u as L,a as z,f as N,j as W,w as X}from"../chunks/firebase.d7i5Tn_k.js";const be=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global,{console:ge}=be,A="C:/Users/amine/Desktop/Learning/svelte/linke-tree/src/routes/login/username/+page.svelte";function ee(i){let e,t,a,n,o,l,s,c,P,f=i[1]&&H(i),m=!i[3]&&i[5]&&Y(i),d=i[3]&&!i[2]&&!i[1]&&q(i),h=i[3]&&i[2]&&G(i);const v={c:function(){e=w("form"),t=w("input"),a=E(),n=w("div"),f&&f.c(),o=E(),m&&m.c(),l=E(),d&&d.c(),s=E(),h&&h.c(),this.h()},l:function(u){e=C(u,"FORM",{class:!0});var p=B(e);t=C(p,"INPUT",{type:!0,placeholder:!0,class:!0}),a=j(p),n=C(p,"DIV",{class:!0});var r=B(n);f&&f.l(r),o=j(r),m&&m.l(r),l=j(r),d&&d.l(r),s=j(r),h&&h.l(r),r.forEach(b),p.forEach(b),this.h()},h:function(){k(t,"type","text"),k(t,"placeholder","Username"),k(t,"class","input w-full"),D(t,"input-error",!i[3]&&i[5]),D(t,"input-warning",i[4]),D(t,"input-success",i[2]&&i[3]&&!i[1]),T(t,A,74,6,1915),k(n,"class","my-4 min-h-16 px-8 w-full"),T(n,A,87,6,2349),k(e,"class","w-5/6 sm:w-3/6"),T(e,A,73,4,1835)},m:function(u,p){y(u,e,p),g(e,t),Q(t,i[0]),g(e,a),g(e,n),f&&f.m(n,null),g(n,o),m&&m.m(n,null),g(n,l),d&&d.m(n,null),g(n,s),h&&h.m(n,null),c||(P=[O(t,"input",i[9]),O(t,"input",i[7],!1,!1,!1,!1),O(e,"submit",oe(i[8]),!1,!0,!1,!1)],c=!0)},p:function(u,p){p&1&&t.value!==u[0]&&Q(t,u[0]),p&40&&D(t,"input-error",!u[3]&&u[5]),p&16&&D(t,"input-warning",u[4]),p&14&&D(t,"input-success",u[2]&&u[3]&&!u[1]),u[1]?f?f.p(u,p):(f=H(u),f.c(),f.m(n,o)):f&&(f.d(1),f=null),!u[3]&&u[5]?m||(m=Y(u),m.c(),m.m(n,l)):m&&(m.d(1),m=null),u[3]&&!u[2]&&!u[1]?d?d.p(u,p):(d=q(u),d.c(),d.m(n,s)):d&&(d.d(1),d=null),u[3]&&u[2]?h?h.p(u,p):(h=G(u),h.c(),h.m(n,null)):h&&(h.d(1),h=null)},d:function(u){u&&b(e),f&&f.d(),m&&m.d(),d&&d.d(),h&&h.d(),c=!1,ae(P)}};return U("SvelteRegisterBlock",{block:v,id:ee.name,type:"else",source:"(63:2) {:else}",ctx:i}),v}function te(i){let e,t,a,n,o=i[6].username+"",l,s,c,P="*Usernames cannot be changed*",f,m,d="Upload Profile Image";const h={c:function(){e=w("h2"),t=R("Your username is "),a=w("span"),n=R("@"),l=R(o),s=E(),c=w("p"),c.textContent=P,f=E(),m=w("a"),m.textContent=d,this.h()},l:function(_){e=C(_,"H2",{class:!0});var u=B(e);t=S(u,"Your username is "),a=C(u,"SPAN",{class:!0});var p=B(a);n=S(p,"@"),l=S(p,o),p.forEach(b),u.forEach(b),s=j(_),c=C(_,"P",{class:!0,"data-svelte-h":!0}),F(c)!=="svelte-14cbc0k"&&(c.textContent=P),f=j(_),m=C(_,"A",{href:!0,class:!0,"data-svelte-h":!0}),F(m)!=="svelte-1xyzfcd"&&(m.textContent=d),this.h()},h:function(){k(a,"class","text-green-500"),T(a,A,61,23,1515),k(e,"class","text-lg sm:text-xl font-semibold text-white -mb-2"),T(e,A,60,4,1428),k(c,"class","mb-3 text-red-500"),T(c,A,66,4,1609),k(m,"href","/login/photo"),k(m,"class","btn btn-primary px-10 text-white font-semibold sm:text-lg"),T(m,A,67,4,1677)},m:function(_,u){y(_,e,u),g(e,t),g(e,a),g(a,n),g(a,l),y(_,s,u),y(_,c,u),y(_,f,u),y(_,m,u)},p:function(_,u){u&64&&o!==(o=_[6].username+"")&&I(l,o)},d:function(_){_&&(b(e),b(s),b(c),b(f),b(m))}};return U("SvelteRegisterBlock",{block:h,id:te.name,type:"if",source:"(50:2) {#if $userData?.username}",ctx:i}),h}function H(i){let e,t,a,n;const o={c:function(){e=w("p"),t=R("Checking availability of @"),a=R(i[0]),n=R("..."),this.h()},l:function(s){e=C(s,"P",{class:!0});var c=B(e);t=S(c,"Checking availability of @"),a=S(c,i[0]),n=S(c,"..."),c.forEach(b),this.h()},h:function(){k(e,"class","text-secondary"),T(e,A,89,10,2423)},m:function(s,c){y(s,e,c),g(e,t),g(e,a),g(e,n)},p:function(s,c){c&1&&I(a,s[0])},d:function(s){s&&b(e)}};return U("SvelteRegisterBlock",{block:o,id:H.name,type:"if",source:"(79:8) {#if loading}",ctx:i}),o}function Y(i){let e,t="must be 3-16 characters long, alphanumeric only";const a={c:function(){e=w("p"),e.textContent=t,this.h()},l:function(o){e=C(o,"P",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-1wurl8l"&&(e.textContent=t),this.h()},h:function(){k(e,"class","text-error text-sm"),T(e,A,93,10,2558)},m:function(o,l){y(o,e,l)},d:function(o){o&&b(e)}};return U("SvelteRegisterBlock",{block:a,id:Y.name,type:"if",source:"(83:8) {#if !isValid && isTouched}",ctx:i}),a}function q(i){let e,t,a,n;const o={c:function(){e=w("p"),t=R("@"),a=R(i[0]),n=R(" is not available"),this.h()},l:function(s){e=C(s,"P",{class:!0});var c=B(e);t=S(c,"@"),a=S(c,i[0]),n=S(c," is not available"),c.forEach(b),this.h()},h:function(){k(e,"class","text-warning text-sm"),T(e,A,99,10,2745)},m:function(s,c){y(s,e,c),g(e,t),g(e,a),g(e,n)},p:function(s,c){c&1&&I(a,s[0])},d:function(s){s&&b(e)}};return U("SvelteRegisterBlock",{block:o,id:q.name,type:"if",source:"(89:8) {#if isValid && !isAvailable && !loading}",ctx:i}),o}function G(i){let e,t,a;const n={c:function(){e=w("button"),t=R("Confirm Username @"),a=R(i[0]),this.h()},l:function(l){e=C(l,"BUTTON",{class:!0});var s=B(e);t=S(s,"Confirm Username @"),a=S(s,i[0]),s.forEach(b),this.h()},h:function(){k(e,"class","btn btn-success text-white"),T(e,A,105,10,2902)},m:function(l,s){y(l,e,s),g(e,t),g(e,a)},p:function(l,s){s&1&&I(a,l[0])},d:function(l){l&&b(e)}};return U("SvelteRegisterBlock",{block:n,id:G.name,type:"if",source:"(95:8) {#if isValid && isAvailable}",ctx:i}),n}function ne(i){let e;function t(l,s){return l[6]?.username?te:ee}let a=t(i),n=a(i);const o={c:function(){n.c(),e=K()},l:function(s){n.l(s),e=K()},m:function(s,c){n.m(s,c),y(s,e,c)},p:function(s,c){a===(a=t(s))&&n?n.p(s,c):(n.d(1),n=a(s),n&&(n.c(),n.m(e.parentNode,e)))},d:function(s){s&&b(e),n.d(s)}};return U("SvelteRegisterBlock",{block:o,id:ne.name,type:"slot",source:"(49:0) <AuthCheck>",ctx:i}),o}function M(i){let e,t;e=new $({props:{$$slots:{default:[ne]},$$scope:{ctx:i}},$$inline:!0});const a={c:function(){fe(e.$$.fragment)},l:function(o){me(e.$$.fragment,o)},m:function(o,l){de(e,o,l),t=!0},p:function(o,[l]){const s={};l&4223&&(s.$$scope={dirty:l,ctx:o}),e.$set(s)},i:function(o){t||(he(e.$$.fragment,o),t=!0)},o:function(o){_e(e.$$.fragment,o),t=!1},d:function(o){pe(e,o)}};return U("SvelteRegisterBlock",{block:a,id:M.name,type:"component",source:"",ctx:i}),a}const x=/^(?=[a-zA-Z0-9._]{3,16}$)(?!.*[_.]{2})[^_.].*[^_.]$/;function ke(i,e,t){let a,n,o,l,s;Z(L,"user"),J(i,L,r=>t(11,l=r)),Z(z,"userData"),J(i,z,r=>t(6,s=r));let{$$slots:c={},$$scope:P}=e;re("Page",c,[]);let f="",m=!1,d=!1,h;async function v(){t(2,d=!1),t(1,m=!0),clearTimeout(h),h=setTimeout(async()=>{console.log("Checking availability of ",f);const r=N(V,"usernames",f),ie=await W(r).then(se=>se.exists());t(2,d=!ie),t(1,m=!1)},500)}async function _(){const r=X(V);r.set(N(V,"usernames",f),{uid:l?.uid}),r.set(N(V,"users",l.uid),{username:f,photoURL:l?.photoURL??null,published:!0,bio:"I am a software developer",links:[{title:"Upwork",url:"https://upwork.com",icon:"custom"}]}),r.commit(),t(0,f=""),t(2,d=!1)}const u=[];Object.keys(e).forEach(r=>{!~u.indexOf(r)&&r.slice(0,2)!=="$$"&&r!=="slot"&&ge.warn(`<Page> was created with unknown prop '${r}'`)});function p(){f=this.value,t(0,f)}return i.$capture_state=()=>({AuthCheck:$,db:V,user:L,userData:z,doc:N,getDoc:W,writeBatch:X,username:f,loading:m,isAvailable:d,re:x,debounceTimer:h,checkAvailability:v,confirmUsername:_,isValid:a,isTaken:o,isTouched:n,$user:l,$userData:s}),i.$inject_state=r=>{"username"in r&&t(0,f=r.username),"loading"in r&&t(1,m=r.loading),"isAvailable"in r&&t(2,d=r.isAvailable),"debounceTimer"in r&&(h=r.debounceTimer),"isValid"in r&&t(3,a=r.isValid),"isTaken"in r&&t(4,o=r.isTaken),"isTouched"in r&&t(5,n=r.isTouched)},e&&"$$inject"in e&&i.$inject_state(e.$$inject),i.$$.update=()=>{i.$$.dirty&1&&t(3,a=f?.length>2&&f.length<16&&x.test(f)),i.$$.dirty&1&&t(5,n=f.length>0),i.$$.dirty&14&&t(4,o=a&&!d&&!m)},[f,m,d,a,o,n,s,v,_,p]}class Te extends ue{constructor(e){super(e),ce(this,e,ke,M,le,{}),U("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:M.name})}}export{Te as component};
